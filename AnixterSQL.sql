
--Access SQL
Tiffin

SELECT T.Tiff_Part AS TIFFIN_PN, 
T.ANX_Part AS [ANIXTER _PN], 
T.DESC1 AS DESCRIPTION, 
W.LOC_I AS WAREHOUSE, 
W.ONHAND_Q AS STOCK, 
W.ALLCTD_Q AS ALLOCATED, 
W.ON_ORDR_Q AS ON_ORDER
FROM TiffinStock AS T INNER JOIN dbo_IA_TSTOCK_WEEKLY AS W ON T.ANX_Part = W.ANX_ITEM_I
WHERE W.LOC_I LIKE 175;

TriCitties

SELECT T.PN AS TRI_PN, 
T.ANX_Part AS [ANIXTER _PN], 
T.DESC1 AS DESCRIPTION, 
W.LOC_I AS WAREHOUSE, 
W.ONHAND_Q AS STOCK, 
W.ALLCTD_Q AS ALLOCATED, 
W.ON_ORDR_Q AS ON_ORDER
FROM TriStock AS T INNER JOIN dbo_IA_TSTOCK_WEEKLY AS W ON T.ANX_Part = W.ANX_ITEM_I
WHERE W.LOC_I LIKE 175;


-MySQL - 
Tiffin

--Memphis Stock--
SELECT W.ANX_ITEM_I, 
SUM(W.ONHAND_Q - W.ALLCTD_Q) AS [MEMPHIS_STOCK], 
SUM(W.ON_ORDR_Q) AS [MEMPHIS_RESTOCK_ORDER]
INTO #LOCAL
FROM dbo.IA_VSTOCK_DAILY AS W 
WHERE W.COUNTRY_I LIKE 'U.S.A.'
AND W.ANX_ITEM_I IN ('5JBX-0401-02','5JBX-0401-03-TIF','6GXL-0801UL-9-TIF','6GXL-0801UL-4-TIF','6GXL-1001UL-9-TIF','6GXL-1001UL-4-TIF','6GXL-1201UL-9-TIF','6GXL-1201UL-4-TIF','6GXL-1201UL-0','6GXL-1401UL-9-TIF','6GXL-1401UL-4-TIF','6GXL-1601UL-9-TIF','6GXL-1601UL-4-TIF','5J-2021-03','5J-0201-03','5J-4041','5J-4041-03','5J-0201','5J-2021','5JBX-0601-05-TIF')
and LOC_I LIKE('175')
GROUP BY W.ANX_ITEM_I;

--USA Stock--
SELECT W.ANX_ITEM_I, 
SUM(W.ONHAND_Q - W.ALLCTD_Q) AS [USA_STOCK], 
SUM(W.ON_ORDR_Q) AS [USA_RESTOCK_ORDER]
INTO #GLOBAL
FROM dbo.IA_VSTOCK_DAILY AS W 
WHERE W.COUNTRY_I LIKE 'U.S.A.'
AND W.ANX_ITEM_I IN ('5JBX-0401-02','5JBX-0401-03-TIF','6GXL-0801UL-9-TIF','6GXL-0801UL-4-TIF','6GXL-1001UL-9-TIF','6GXL-1001UL-4-TIF','6GXL-1201UL-9-TIF','6GXL-1201UL-4-TIF','6GXL-1201UL-0','6GXL-1401UL-9-TIF','6GXL-1401UL-4-TIF','6GXL-1601UL-9-TIF','6GXL-1601UL-4-TIF','5J-2021-03','5J-0201-03','5J-4041','5J-4041-03','5J-0201','5J-2021','5JBX-0601-05-TIF')
and LOC_I NOT LIKE('175')
GROUP BY W.ANX_ITEM_I;

--Cust Part Number--
SELECT ANX_ITEM_I,
CUST_ITEM_I AS [PART_NUMBER]
INTO #CUST
FROM dbo.IA_TCUST_ITEMS
WHERE CUST_I LIKE '259829';

--USA Cost--
SELECT ANX_ITEM_I,
AVG(CNTRY_ACCTG_UNIT_CST_A) AS [ACCT_PRICE]
INTO #USA_PRICE
FROM dbo.IA_VSTOCK_DAILY
WHERE COUNTRY_I LIKE 'U.S.A.'
AND ANX_ITEM_I IN ('5JBX-0401-02','5JBX-0401-03-TIF','6GXL-0801UL-9-TIF','6GXL-0801UL-4-TIF','6GXL-1001UL-9-TIF','6GXL-1001UL-4-TIF','6GXL-1201UL-9-TIF','6GXL-1201UL-4-TIF','6GXL-1201UL-0','6GXL-1401UL-9-TIF','6GXL-1401UL-4-TIF','6GXL-1601UL-9-TIF','6GXL-1601UL-4-TIF','5J-2021-03','5J-0201-03','5J-4041','5J-4041-03','5J-0201','5J-2021','5JBX-0601-05-TIF')
GROUP BY ANX_ITEM_I;

--Tiffin Price Sheet--
SELECT 
CASE
  WHEN #CUST.PART_NUMBER IS NULL THEN ''
  ELSE #CUST.PART_NUMBER
END AS [PART],
#LOCAL.ANX_ITEM_I,
#USA_PRICE.ACCT_PRICE,
#LOCAL.MEMPHIS_STOCK,
#LOCAL.MEMPHIS_RESTOCK_ORDER,
CASE 
  WHEN #GLOBAL.USA_STOCK IS NULL THEN 0
  ELSE #GLOBAL.USA_STOCK
  END AS USA_STOCK,
CASE 
  WHEN #GLOBAL.USA_RESTOCK_ORDER IS NULL THEN 0
  ELSE #GLOBAL.USA_RESTOCK_ORDER
  END AS USA_RESTOCK
FROM #LOCAL LEFT JOIN #GLOBAL 
ON #LOCAL.ANX_ITEM_I = #GLOBAL.ANX_ITEM_I
LEFT JOIN #CUST 
ON #CUST.ANX_ITEM_I = #LOCAL.ANX_ITEM_I
LEFT JOIN #USA_PRICE
ON #USA_PRICE.ANX_ITEM_I = #LOCAL.ANX_ITEM_I;

DROP TABLE #LOCAL
DROP TABLE #GLOBAL
DROP TABLE #CUST
DROP TABLE #USA_PRICE

--Tri-Cities--

--Memphis Stock--
SELECT W.ANX_ITEM_I, 
SUM(W.ONHAND_Q - W.ALLCTD_Q) AS [MEMPHIS_STOCK], 
SUM(W.ON_ORDR_Q) AS [MEMPHIS_RESTOCK_ORDER]
INTO #LOCAL
FROM dbo.IA_VSTOCK_DAILY AS W 
WHERE W.COUNTRY_I LIKE 'U.S.A.'
AND W.ANX_ITEM_I IN ('6GXL-0801UL-9-TRI','6GXL-1001UL-0','6GXL-1001UL-9-TRI','6GXL-1001UL-2-TRI','6GXL-1001UL-D6-TRI','6GXL-1201UL-9-TRI','6GXL-1201UL-4','6GXL-1201UL-0','6GXL-1201UL-2-TRI','6GXL-1201UL-96','6GXL-1201UL-93','6GXL-1201UL-D5','6GXL-1401UL-0','6GXL-1401UL-2-TRI','6GXL-1401UL-D6','6GXL-1401UL-4','6GXL-1401UL-8','6GXL-1401UL-9','6GXL-1601UL-0-TRI','6GXL-1601UL-2-TRI','6GXL-1601UL-D5-TRI','6GXL-1601UL-D6','6GXL-1601UL-1-TRI','6GXL-1601UL-4-TRI','6GXL-1601UL-7-TRI','6GXL-1601UL-P','6GXL-1601UL-9-TRI','6GXL-1801UL-8-TRI','6GXL-1801UL-9-TRI','6GXL-1801UL-7-TRI','5JBX-1011-03-TRI','5JBX-0401-03-TRI','5JBX-0401-02-TRI','5J-2021-03','5J-3031-03','TRI-TU1/2POLYDWBLK','TRI-TU1/2POLYDWRED','TRI-TU3/4POLYDWBLK','TRI-TU3/4POLYDWRED','TRI-TU1POLYDWBLK','TRI-TU1POLYDWRED','TRI-LM1/4POLYBLKFORD','TRI-LM3/8POLYBLKFORD','TRI-LM1/2POLYBLKFORD','TRI-LM5/8POLYBLKFORD','TRI-LM3/4POLYBLKFORD','TRI-LM1POLYBLKFORD')
and LOC_I LIKE('175')
GROUP BY W.ANX_ITEM_I;

--USA Stock--
SELECT W.ANX_ITEM_I, 
SUM(W.ONHAND_Q - W.ALLCTD_Q) AS [USA_STOCK], 
SUM(W.ON_ORDR_Q) AS [USA_RESTOCK_ORDER]
INTO #GLOBAL
FROM dbo.IA_VSTOCK_DAILY AS W 
WHERE W.COUNTRY_I LIKE 'U.S.A.'
AND W.ANX_ITEM_I IN ('6GXL-0801UL-9-TRI','6GXL-1001UL-0','6GXL-1001UL-9-TRI','6GXL-1001UL-2-TRI','6GXL-1001UL-D6-TRI','6GXL-1201UL-9-TRI','6GXL-1201UL-4','6GXL-1201UL-0','6GXL-1201UL-2-TRI','6GXL-1201UL-96','6GXL-1201UL-93','6GXL-1201UL-D5','6GXL-1401UL-0','6GXL-1401UL-2-TRI','6GXL-1401UL-D6','6GXL-1401UL-4','6GXL-1401UL-8','6GXL-1401UL-9','6GXL-1601UL-0-TRI','6GXL-1601UL-2-TRI','6GXL-1601UL-D5-TRI','6GXL-1601UL-D6','6GXL-1601UL-1-TRI','6GXL-1601UL-4-TRI','6GXL-1601UL-7-TRI','6GXL-1601UL-P','6GXL-1601UL-9-TRI','6GXL-1801UL-8-TRI','6GXL-1801UL-9-TRI','6GXL-1801UL-7-TRI','5JBX-1011-03-TRI','5JBX-0401-03-TRI','5JBX-0401-02-TRI','5J-2021-03','5J-3031-03','TRI-TU1/2POLYDWBLK','TRI-TU1/2POLYDWRED','TRI-TU3/4POLYDWBLK','TRI-TU3/4POLYDWRED','TRI-TU1POLYDWBLK','TRI-TU1POLYDWRED','TRI-LM1/4POLYBLKFORD','TRI-LM3/8POLYBLKFORD','TRI-LM1/2POLYBLKFORD','TRI-LM5/8POLYBLKFORD','TRI-LM3/4POLYBLKFORD','TRI-LM1POLYBLKFORD')
and LOC_I NOT LIKE('175')
GROUP BY W.ANX_ITEM_I;

--Cust Part Number--
SELECT ANX_ITEM_I,
CUST_ITEM_I AS [PART_NUMBER]
INTO #CUST
FROM dbo.IA_TCUST_ITEMS
WHERE CUST_I LIKE '889453';



--USA Cost--
SELECT ANX_ITEM_I,
CASE 
  WHEN ANX_ITEM_I LIKE ('5J-2021-03') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.845)/1000, 3)
  WHEN ANX_ITEM_I LIKE ('5J-3031-03') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.784)/1000, 3)
  WHEN ANX_ITEM_I LIKE ('5JBX-%') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.87)/1000, 3)
  WHEN ANX_ITEM_I LIKE ('6GXL-%') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.85)/1000, 3)
  WHEN ANX_ITEM_I LIKE ('TRI-LM1/4POLYBLKFORD') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.86)/2500, 3)
  WHEN ANX_ITEM_I LIKE ('TRI-LM3/8POLYBLKFORD') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.86)/5000, 3)
  WHEN ANX_ITEM_I LIKE ('TRI-LM1/2POLYBLKFORD') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.86)/4000, 3)
  WHEN ANX_ITEM_I LIKE ('TRI-LM5/8POLYBLKFORD') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.86)/2500, 3)
  WHEN ANX_ITEM_I LIKE ('TRI-LM3/4POLYBLKFORD') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.86)/2000, 3)
  WHEN ANX_ITEM_I LIKE ('TRI-LM1POLYBLKFORD') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.86)/1250, 3)
  WHEN ANX_ITEM_I LIKE ('TRI-TU%') THEN ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.66)/100, 2)
  ELSE ROUND((AVG(CNTRY_ACCTG_UNIT_CST_A)/.82)/1000, 3)
  END AS [PRICE]
INTO #USA_PRICE
FROM dbo.IA_VSTOCK_DAILY
WHERE COUNTRY_I LIKE 'U.S.A.'
AND ANX_ITEM_I IN ('6GXL-0801UL-9-TRI','6GXL-1001UL-0','6GXL-1001UL-9-TRI','6GXL-1001UL-2-TRI','6GXL-1001UL-D6-TRI','6GXL-1201UL-9-TRI','6GXL-1201UL-4','6GXL-1201UL-0','6GXL-1201UL-2-TRI','6GXL-1201UL-96','6GXL-1201UL-93','6GXL-1201UL-D5','6GXL-1401UL-0','6GXL-1401UL-2-TRI','6GXL-1401UL-D6','6GXL-1401UL-4','6GXL-1401UL-8','6GXL-1401UL-9','6GXL-1601UL-0-TRI','6GXL-1601UL-2-TRI','6GXL-1601UL-D5-TRI','6GXL-1601UL-D6','6GXL-1601UL-1-TRI','6GXL-1601UL-4-TRI','6GXL-1601UL-7-TRI','6GXL-1601UL-P','6GXL-1601UL-9-TRI','6GXL-1801UL-8-TRI','6GXL-1801UL-9-TRI','6GXL-1801UL-7-TRI','5JBX-1011-03-TRI','5JBX-0401-03-TRI','5JBX-0401-02-TRI','5J-2021-03','5J-3031-03','TRI-TU1/2POLYDWBLK','TRI-TU1/2POLYDWRED','TRI-TU3/4POLYDWBLK','TRI-TU3/4POLYDWRED','TRI-TU1POLYDWBLK','TRI-TU1POLYDWRED','TRI-LM1/4POLYBLKFORD','TRI-LM3/8POLYBLKFORD','TRI-LM1/2POLYBLKFORD','TRI-LM5/8POLYBLKFORD','TRI-LM3/4POLYBLKFORD','TRI-LM1POLYBLKFORD')
GROUP BY ANX_ITEM_I;

SELECT 
CASE
  WHEN #CUST.PART_NUMBER IS NULL THEN ''
  ELSE #CUST.PART_NUMBER
END AS [PART],
#LOCAL.ANX_ITEM_I,
#USA_PRICE.PRICE,
#LOCAL.MEMPHIS_STOCK,
#LOCAL.MEMPHIS_RESTOCK_ORDER,
CASE 
  WHEN #GLOBAL.USA_STOCK IS NULL THEN 0
  ELSE #GLOBAL.USA_STOCK
  END AS USA_STOCK,
CASE 
  WHEN #GLOBAL.USA_RESTOCK_ORDER IS NULL THEN 0
  ELSE #GLOBAL.USA_RESTOCK_ORDER
  END AS USA_RESTOCK
FROM #LOCAL LEFT JOIN #GLOBAL 
ON #LOCAL.ANX_ITEM_I = #GLOBAL.ANX_ITEM_I
LEFT JOIN #CUST 
ON #CUST.ANX_ITEM_I = #LOCAL.ANX_ITEM_I
LEFT JOIN #USA_PRICE
ON #USA_PRICE.ANX_ITEM_I = #LOCAL.ANX_ITEM_I;

DROP TABLE #LOCAL
DROP TABLE #GLOBAL
DROP TABLE #CUST
DROP TABLE #USA_PRICE

--CARA BILEK 5J Acct Cost--
SELECT W.ANX_ITEM_I, 
CNTRY_ACCTG_UNIT_CST_A
FROM dbo.IA_TSTOCK_DAILY AS W 
WHERE W.COUNTRY_I LIKE 'U.S.A.'
AND W.ANX_ITEM_I IN ('5J-3031-03','5J-2021-03','5J-0201-03','5J-4041','5J-4041-03','5J-0201','5J-2021')
AND LOC_I LIKE('010');

--JON SKYBA Acct Costs--
SELECT W.ANX_ITEM_I, 
CNTRY_ACCTG_UNIT_CST_A
FROM dbo.IA_VSTOCK_DAILY AS W 
WHERE W.COUNTRY_I LIKE 'U.S.A.'
AND W.ANX_ITEM_I IN ('6GXL-0801UL-9-TRI','6GXL-1001UL-0','6GXL-1001UL-9-TRI','6GXL-1001UL-2-TRI','6GXL-1001UL-D6-TRI','6GXL-1201UL-9-TRI','6GXL-1201UL-4','6GXL-1201UL-0','6GXL-1201UL-2-TRI','6GXL-1201UL-96','6GXL-1201UL-93','6GXL-1201UL-D5','6GXL-1401UL-0','6GXL-1401UL-2-TRI','6GXL-1401UL-D6','6GXL-1401UL-4','6GXL-1401UL-8','6GXL-1401UL-9','6GXL-1601UL-0-TRI','6GXL-1601UL-2-TRI','6GXL-1601UL-D5-TRI','6GXL-1601UL-D6','6GXL-1601UL-1-TRI','6GXL-1601UL-4-TRI','6GXL-1601UL-7-TRI','6GXL-1601UL-P','6GXL-1601UL-9-TRI','6GXL-1801UL-8-TRI','6GXL-1801UL-9-TRI','6GXL-1801UL-7-TRI','5JBX-1011-03-TRI','5JBX-0401-03-TRI','5JBX-0401-02-TRI','5J-2021-03','5J-3031-03','TRI-TU1/2POLYDWBLK','TRI-TU1/2POLYDWRED','TRI-TU3/4POLYDWBLK','TRI-TU3/4POLYDWRED','TRI-TU1POLYDWBLK','TRI-TU1POLYDWRED','TRI-LM1/4POLYBLKFORD','TRI-LM3/8POLYBLKFORD','TRI-LM1/2POLYBLKFORD','TRI-LM5/8POLYBLKFORD','TRI-LM3/4POLYBLKFORD','TRI-LM1POLYBLKFORD')
AND LOC_I LIKE('175');


--HH TECH 2019 SOLD Items with QTY --

SELECT 
	  [ANX_ITEM_I]
      ,SUM([BOOKBILL_Q]) AS [QTY]
      ,SUM([EXTND_UNIT_PRC_A]) AS [Ext Sell]
      ,SUM([EXTND_STD_CST_A]) AS [Ext Cost]
  FROM [iadacces].[dbo].[IA_VBOOKINGS2019]
  WHERE CUST_I LIKE '889748'
  GROUP BY ANX_ITEM_I;
  
  --HH TECH List of Material QTY Used with QTY Sold by Anixter--
  
SELECT HHBillofMaterial.*
, HHUsageandQTYSold.QTYSOLD
FROM HHBillofMaterial LEFT JOIN HHUsageandQTYSold 
ON HHBillofMaterial.HHPN = HHUsageandQTYSold.HHPN
ORDER BY HHBillofMaterial.USAGE DESC ;

--HH Tech Presentation --

SELECT PresintationWOSellCost.HHPN
, PresintationWOSellCost.ANX_PN
, PresintationWOSellCost.DESC
, PresintationWOSellCost.HHUSAGE
, PresintationWOSellCost.QTYSOLD
, SellCost.SELL
, SellCost.COST
FROM PresintationWOSellCost INNER JOIN SellCost 
ON PresintationWOSellCost.ANX_PN = SellCost.ANX_PN
ORDER BY PresintationWOSellCost.HHUSAGE DESC;

--HH Tech Top 20 Usage and POs--
Select *
FROM IA_VSALES_HISTORY_2018_2019
WHERE CUST_I LIKE '889748'
AND ANX_ITEM_I IN ('6TXL-1601-0','6TXL-1801-2', '6TXL-1801-9','6TXL-1601-9','6TXL-1601-3','6TXL-1801-0','6TXL-1601-2','6GXL-1601-2','6TXL-1801-6','6TXL-1801-3','6TXL-2201-0','6GXL-1601-9','6TXL-1801-4','6GXL-1801-0','6TXL-1801-8','6TXL-1801-P','6TXL-1801-5','6GXL-1801-2','6GXL-1601-P','6TXL-1801-7');
